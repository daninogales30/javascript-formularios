<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario 2</title>
    <style>
        #errores{
            color: red;
        }
    </style>
</head>

<body>
    <h1>Formulario ej2</h1>
    <h2>Formulario provincia de Cádiz</h2>
    <form action="grabar.php" method="post" onsubmit="return validarFormulario(this)">
        <label for="usuario">Nombre de usuario</label>
        <input type="text" name="usuario" id="usuario" placeholder="Indica su nombre de usuario" required><br><br>

        <label for="password">Contraseña: </label>
        <input type="password" name="password" id="password" required placeholder="Indica su contraseña"><br><br>

        <label for="poblacion">Población: </label>
        <select name="poblacion" id="poblacion">
            <option value="selecciona">- Seleccione -</option>
            <option value="gazules">Alcalá de los Gazules</option>
            <option value="delvalle">Alcalá del Valle</option>
            <option value="bornos">Bornos</option>
            <option value="chiclana">Chiclana de la Frontera</option>
            <option value="jerezfrontera">Jerez de la Frontera</option>
            <option value="sanlucar">Sanlúcar de Barrameda</option>
        </select><br><br>

        <button type="submit">Enviar formulario</button>
    </form>

    <p id="errores"></p>

    <script>
        function validarFormulario(form) {
            const inputUsuario = form.usuario.value;
            const inputPassword = form.password.value;
            const inputPoblacion = form.poblacion.value;

            const expRegNombre = /^[^\s]{8,}$/;
            const expRegPassword = /^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{6,10}$/;

            if (!expRegNombre.test(inputUsuario)) {
                document.getElementById("errores").textContent = "El usuario no es válido ya que debe tener al menos 8 caracteres y no debe contener espacios.";
                return false;
            }

            if (!expRegPassword.test(inputPassword)) {
                document.getElementById("errores").textContent = "La contraseña no es válida ya que debe tener entre 6 y 10 caracteres alfanuméricos, y debe contener al menos un dígito y una letra mayúscula.";
                return false;
            }

            if (inputPoblacion == "selecciona") {
                document.getElementById("errores").textContent = "Porfavor, seleccione una de las poblaciones posibles";
                return false;
            }
            return true;
        }
    </script>
</body>

</html>